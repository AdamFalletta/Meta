<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Strength: Weekly Fitness Log</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #1e1e1e;
            padding: 10px 20px;
        }
        header h1 {
            font-size: 18px;
        }
        header .date-display {
            font-size: 16px;
        }
        .week-controls {
            display: flex;
            justify-content: center;
            margin: 10px 0;
        }
        .week-controls button {
            background-color: #1e1e1e;
            color: #f5f5f5;
            border: 1px solid #333;
            padding: 5px 10px;
            cursor: pointer;
        }
        .week-controls button:hover {
            background-color: #007bff;
            color: #fff;
        }
        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 20px;
        }
        .day-column {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 10px;
        }
        .day-header {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
        }
        table th, table td {
            padding: 8px;
            text-align: center;
            border: 1px solid #333;
        }
        .add-workout {
            display: block;
            background-color: #007bff;
            color: #fff;
            text-align: center;
            padding: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        .popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }
        .popup.active {
            display: flex;
        }
        .popup-content {
            background-color: #1e1e1e;
            padding: 20px;
            border-radius: 8px;
            color: #f5f5f5;
            width: 300px;
        }
        .popup-content input {
            width: 100%;
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #333;
            background-color: #121212;
            color: #f5f5f5;
        }
        .popup-buttons {
            display: flex;
            justify-content: space-between;
        }
        .popup-buttons button {
            flex: 1;
            margin: 0 5px;
            padding: 8px;
            border: none;
            cursor: pointer;
        }
        .popup-buttons button.save {
            background-color: #007bff;
            color: #fff;
        }
        .popup-buttons button.cancel {
            background-color: #444;
            color: #fff;
        }
    </style>
</head>
<body>
    <header>
        <h1>Cyber Strength</h1>
        <div class="date-display"></div>
    </header>
    <div class="week-controls">
        <button id="prev-week">Previous Week</button>
        <button id="next-week">Next Week</button>
    </div>
    <div class="content" id="content"></div>

    <div class="popup" id="popup">
        <div class="popup-content">
            <h3>Edit Workout</h3>
            <input type="text" id="exercise" placeholder="Exercise">
            <input type="number" id="weight" placeholder="Weight">
            <input type="number" id="sets" placeholder="Sets">
            <input type="number" id="reps" placeholder="Reps">
            <div class="popup-buttons">
                <button class="save" id="save-workout">Save</button>
                <button class="cancel" id="cancel-workout">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday", "Notes"];
        let currentDate = new Date();
        let currentWeekStart;

        const content = document.getElementById('content');
        const popup = document.getElementById('popup');
        const dateDisplay = document.querySelector('.date-display');

        const exerciseInput = document.getElementById('exercise');
        const weightInput = document.getElementById('weight');
        const setsInput = document.getElementById('sets');
        const repsInput = document.getElementById('reps');

        const saveWorkoutBtn = document.getElementById('save-workout');
        const cancelWorkoutBtn = document.getElementById('cancel-workout');

        function initialize() {
            calculateWeekStart();
            updateWeekDisplay();
            renderDays();
        }

        function calculateWeekStart() {
            const dayOffset = currentDate.getDay() || 7; // Sunday is 0, adjust to 7
            currentWeekStart = new Date(currentDate);
            currentWeekStart.setDate(currentDate.getDate() - (dayOffset - 1));
        }

        function updateWeekDisplay() {
            const month = currentWeekStart.toLocaleString('default', { month: 'long' });
            const year = currentWeekStart.getFullYear();
            dateDisplay.textContent = `${month} ${year}`;
        }

        function renderDays() {
            content.innerHTML = "";
            days.forEach((day, index) => {
                const column = document.createElement('div');
                column.className = 'day-column';

                const header = document.createElement('div');
                header.className = 'day-header';
                header.textContent = day;

                const addButton = document.createElement('div');
                addButton.className = 'add-workout';
                addButton.textContent = "Add Workout";
                addButton.addEventListener('click', () => openPopup(index));

                column.appendChild(header);

                if (day !== "Notes") {
                    const table = document.createElement('table');
                    const thead = document.createElement('thead');
                    const tr = document.createElement('tr');
                    ["Exercise", "Weight", "Sets", "Reps"].forEach(headerText => {
                        const th = document.createElement('th');
                        th.textContent = headerText;
                        tr.appendChild(th);
                    });
                    thead.appendChild(tr);
                    table.appendChild(thead);

                    const tbody = document.createElement('tbody');
                    tbody.id = `workout-data-${index}`;
                    table.appendChild(tbody);

                    column.appendChild(table);
                }

                column.appendChild(addButton);
                content.appendChild(column);
            });
        }

        function openPopup(dayIndex) {
            popup.classList.add('active');
            saveWorkoutBtn.onclick = () => saveWorkout(dayIndex);
            cancelWorkoutBtn.onclick = closePopup;
        }

        function closePopup() {
            popup.classList.remove('active');
            exerciseInput.value = "";
            weightInput.value = "";
            setsInput.value = "";
            repsInput.value = "";
        }

        function saveWorkout(dayIndex) {
            const workout = {
                exercise: exerciseInput.value,
                weight: weightInput.value,
                sets: setsInput.value,
                reps: repsInput.value,
            };
            const dayKey = `${currentWeekStart.toISOString()}-day-${dayIndex}`;
            const workouts = JSON.parse(localStorage.getItem(dayKey)) || [];
            workouts.push(workout);
            localStorage.setItem(dayKey, JSON.stringify(workouts));
            renderWorkouts(dayIndex);
            closePopup();
        }

        function renderWorkouts(dayIndex) {
            const dayKey = `${currentWeekStart.toISOString()}-day-${dayIndex}`;
            const workouts = JSON.parse(localStorage.getItem(dayKey)) || [];
            const tbody = document.getElementById(`workout-data-${dayIndex}`);
            tbody.innerHTML = "";
            workouts.forEach(workout => {
                const tr = document.createElement('tr');
                ["exercise", "weight", "sets", "reps"].forEach(key => {
                    const td = document.createElement('td');
                    td.textContent = workout[key];
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
        }

        document.getElementById('prev-week').addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() - 7);
            initialize();
        });

        document.getElementById('next-week').addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() + 7);
            initialize();
        });

        initialize();
    </script>
</body>
</html>
